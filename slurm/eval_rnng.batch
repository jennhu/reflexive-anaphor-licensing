#!/bin/bash
#SBATCH --qos=cpl
#SBATCH -J eval_rnng # A single job name for the array
#SBATCH -n 1 # one core
#SBATCH -N 1 # on one node
#SBATCH --time=0-12:00
#SBATCH --mem=10G
#SBATCH -o logs/eval_rnng_%j.out # Standard output
#SBATCH -e logs/eval_rnng_%j.err # Standard error
#SBATCH --mail-user=jennhu@mit.edu # -- use this to send an automated email when:
#SBATCH --mail-type=end            # -- your job completes successfully
#SBATCH --mail-type=fail           # -- or if your job fails

DEPENDENCIES="/om/user/jennhu/rnng-incremental/dependencies"
export LD_LIBRARY_PATH="${DEPENDENCIES}/boost_1_68_0/lib"

MATERIALS="/om/user/jennhu/rnng-refl/materials"
DATA="/om/user/jennhu/rnng-refl/surprisal_data/rnng"
EXP=$1
#"loc"

cd /om/user/jennhu/rnng-incremental/
build/nt-parser/nt-parser-gen --dynet-mem 2000  -x -T train_gen.oracle \
    -v ${MATERIALS}/${EXP}_sentences_no_eos.txt \
    -f ${DATA}/${EXP}_surprisal_rnng.txt \
    --clusters clusters-train-berk.txt \
    --input_dim 256 --lstm_input_dim 256 --hidden_dim 256 \
    -m ntparse_gen_D0.3_2_256_256_16_256-pid20681.params